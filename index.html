<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>P3 Email Writing Practice</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; max-width: 820px; }
    .box { border: 1px solid #ccc; border-radius: 14px; padding: 16px; }
    label { display:block; margin-top: 10px; font-weight: 700; }
    input, textarea, select {
      width: 100%;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid #bbb;
      font-size: 16px;
    }
    textarea { min-height: 220px; line-height: 1.35; }
    button {
      margin-top: 14px;
      padding: 10px 14px;
      border: 0;
      border-radius: 12px;
      cursor: pointer;
      font-size: 16px;
    }
    .hint { color:#444; font-size: 0.98em; }
    .warn {
      margin-top: 10px;
      padding: 10px 12px;
      border-radius: 12px;
      background: #fff6d6;
      border: 1px solid #f0d27a;
    }
    .result {
      margin-top: 16px;
      padding: 14px;
      border-radius: 12px;
      background: #f5f5f5;
      white-space: pre-wrap;
    }
  </style>
</head>
<body>

  <h2>âœ‰ï¸ P3 Email Writing Practice</h2>

  <p class="hint">
    This is a practice email. It does not send a real email.
  </p>

  <div class="warn">
    <strong>âš ï¸ Safety reminder:</strong>
    Do not type passwords, phone numbers, home addresses, or NRIC.
  </div>

  <div class="box">

    <label>To</label>
    <select id="to">
      <option>ğŸ§‘â€ğŸ« formteacher@school.edu (Teacher)</option>
      <option>ğŸ« schooloffice@school.edu (School Office)</option>
      <option>ğŸ‘¨â€ğŸ’¼ principal@school.edu (Principal)</option>
      <option>ğŸ‘« friend@school.edu (Friend)</option>
    </select>

    <label>Subject</label>
    <input id="subject" />

    <label>Message</label>
    <textarea id="message"></textarea>

    <button id="checkBtn">Check my email</button>

    <div id="output" class="result" style="display:none;"></div>
  </div>

  <script>
    function quickCheck({ subject, message }) {
      const notes = [];
      const stars = [];

      const msgTrim = message.trim();

      const subjectOk = subject.trim().length >= 3;
      const hasGreeting = /^(dear|hi|hello)\b/i.test(msgTrim);
      const hasPurpose = /i am writing to/i.test(message);
      const enoughWords = msgTrim.split(/\s+/).filter(Boolean).length >= 25;
      const hasClosing = /\bthank you\b|\bregards\b|\byours\b/i.test(message);
      const hasFrom = /\bfrom\s*,?/i.test(message);

      // Safety checks
      const hasPhoneLike = /\b\d{8}\b/.test(message);
      const hasNricLike = /\b[STFG]\d{7}[A-Z]\b/i.test(message);

      // Stars (positives)
      if (subjectOk) stars.push("â­ You wrote a subject.");
      if (hasGreeting) stars.push("â­ You started with a greeting.");
      if (hasPurpose) stars.push("â­ You stated your purpose.");
      if (enoughWords) stars.push("â­ You added some details.");
      if (hasClosing) stars.push("â­ You ended politely.");
      if (hasFrom) stars.push("â­ You signed off your email.");

      while (stars.length < 2) {
        stars.push("â­ Good effort â€” keep improving!");
      }

      // Improvement notes
      if (!subjectOk) notes.push("- Add a subject (at least 3 letters).");
      if (!hasGreeting) notes.push("- Start with a greeting (Dear / Hi / Hello).");
      if (!hasPurpose) notes.push("- State your purpose clearly (e.g. â€œI am writing to â€¦â€).");
      if (!enoughWords) notes.push("- Add more details (what / when / why).");
      if (!hasClosing) notes.push("- End with a polite closing (e.g. Thank you).");
      if (!hasFrom) notes.push("- End with â€œFrom,â€ and your name.");

      if (hasPhoneLike) notes.push("- Remove phone numbers (safety rule).");
      if (hasNricLike) notes.push("- Remove NRIC-like information (safety rule).");

      const wish =
        (notes[0] || "Try adding one more clear detail.")
          .replace(/^- /, "");

      return { stars, wish, notes };
    }

    document.getElementById("checkBtn").addEventListener("click", () => {
      const data = {
        subject: document.getElementById("subject").value,
        message: document.getElementById("message").value
      };

      const { stars, wish, notes } = quickCheck(data);

      const out = document.getElementById("output");
      out.style.display = "block";
      out.textContent =
        `â­â­ 2 Stars\n- ${stars[0]}\n- ${stars[1]}\n\n` +
        `ğŸŒ± 1 Wish\n- ${wish}\n\n` +
        (notes.length ? `Notes:\n${notes.join("\n")}\n\n` : "") +
        `âš ï¸ Reminder: Do not type passwords, phone numbers, home addresses, or NRIC.`;
    });
  </script>

</body>
</html>
